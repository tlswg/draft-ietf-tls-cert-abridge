<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Abridged Compression for WebPKI Certificates</title>
<meta content="Dennis Jackson" name="author">
<meta content="
       This draft defines a new TLS Certificate Compression scheme which uses a shared dictionary of root and intermediate WebPKI certificates. The scheme smooths the transition to post-quantum certificates by eliminating the root and intermediate certificates from the TLS certificate chain without impacting trust negotiation. It also delivers better compression than alternative proposals whilst ensuring fair treatment for both CAs and website operators. It may also be useful in other applications which store certificate chains, e.g. Certificate Transparency logs. 
    " name="description">
<meta content="xml2rfc 3.19.4" name="generator">
<meta content="draft-ietf-tls-cert-abridge-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.19.4
    Python 3.11.6
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.2.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-tls-cert-abridge.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Abridged Certs</td>
<td class="right">February 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jackson</td>
<td class="center">Expires 1 September 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Transport Layer Security</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tls-cert-abridge-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-02-29" class="published">29 February 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-09-01">1 September 2024</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Jackson</div>
<div class="org">Mozilla</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Abridged Compression for WebPKI Certificates</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This draft defines a new TLS Certificate Compression scheme which uses a shared dictionary of root and intermediate WebPKI certificates. The scheme smooths the transition to post-quantum certificates by eliminating the root and intermediate certificates from the TLS certificate chain without impacting trust negotiation. It also delivers better compression than alternative proposals whilst ensuring fair treatment for both CAs and website operators. It may also be useful in other applications which store certificate chains, e.g. Certificate Transparency logs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://tlswg.github.io/draft-ietf-tls-cert-abridge/draft-ietf-tls-cert-abridge.html">https://tlswg.github.io/draft-ietf-tls-cert-abridge/draft-ietf-tls-cert-abridge.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-tls-cert-abridge/">https://datatracker.ietf.org/doc/draft-ietf-tls-cert-abridge/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Layer Security Working Group mailing list (<span><a href="mailto:tls@ietf.org">mailto:tls@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tls/">https://www.ietf.org/mailman/listinfo/tls/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/tlswg/draft-ietf-tls-cert-abridge">https://github.com/tlswg/draft-ietf-tls-cert-abridge</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 September 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-motivation" class="internal xref">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-relationship-to-other-draft" class="internal xref">Relationship to other drafts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-status" class="internal xref">Status</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-abridged-compression-scheme" class="internal xref">Abridged Compression Scheme</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-pass-1-intermediate-and-roo" class="internal xref">Pass 1: Intermediate and Root Compression</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-enumeration-of-known-interm" class="internal xref">Enumeration of Known Intermediate and Root Certificates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-compression-of-ca-certifica" class="internal xref">Compression of CA Certificates in Certificate Chain</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-pass-2-end-entity-compressi" class="internal xref">Pass 2: End-Entity Compression</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-construction-of-shared-dict" class="internal xref">Construction of Shared Dictionary</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-preliminary-evaluation" class="internal xref">Preliminary Evaluation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-deployment-considerations" class="internal xref">Deployment Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-dictionary-versioning" class="internal xref">Dictionary Versioning</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-version-migration" class="internal xref">Version Migration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-disk-space-requirements" class="internal xref">Disk Space Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-implementation-complexity" class="internal xref">Implementation Complexity</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-ccadb-churn-and-dictionary-" class="internal xref">CCADB Churn and Dictionary Negotiation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-ccadb-churn" class="internal xref">CCADB Churn</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-dictionary-negotiation" class="internal xref">Dictionary Negotiation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.1-1">When a server responds to a TLS Client Hello, the size of its initial flight of packets is limited by the underlying transport protocol. If the size limit is exceeded, the server must wait for the client to acknowledge receipt before concluding the flight, incurring the additional latency of a round trip before the handshake can complete. For TLS handshakes over TCP, the size limit is typically around 14,500 bytes. For TLS handshakes in QUIC, the limit is much lower at a maximum of 4500 bytes (<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>], <a href="https://rfc-editor.org/rfc/rfc9000#section-8.1" class="relref">Section 8.1</a></span>).<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The existing compression schemes used in <span>[<a href="#TLSCertCompress" class="cite xref">TLSCertCompress</a>]</span> have been shown to deliver a substantial improvement in QUIC handshake latency <span>[<a href="#FastlyStudy" class="cite xref">FastlyStudy</a>]</span>, <span>[<a href="#QUICStudy" class="cite xref">QUICStudy</a>]</span> by reducing the size of server's certificate chain and so fitting the server's initial messages within a single flight. However, in a post-quantum setting, the signatures and public keys used in a TLS certificate chain will be typically 10 to 40 times their current size and cannot be compressed with existing TLS Certificate Compression schemes.
Consequently studies <span>[<a href="#SCAStudy" class="cite xref">SCAStudy</a>]</span> <span>[<a href="#PQStudy" class="cite xref">PQStudy</a>]</span> have shown that post-quantum certificate transmission becomes the dominant source of latency in PQ TLS with certificate chains alone expected to exceed even the TCP initial flight limit. This motivates alternative designs for reducing the wire size of post-quantum certificate chains.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-1.2">
        <h3 id="name-overview">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.2-1">This draft introduces a new TLS certificate compression scheme <span>[<a href="#TLSCertCompress" class="cite xref">TLSCertCompress</a>]</span> which is intended specifically for WebPKI applications. It uses a predistributed dictionary consisting of all intermediate and root certificates contained in the root stores of major browsers which is sourced from the Common CA Database <span>[<a href="#CCADB" class="cite xref">CCADB</a>]</span>. As of May 2023, this dictionary would be 3 MB in size and consist of roughly 2000 intermediate certificates and 200 root certificates. The disk footprint can be reduced to near zero as many clients (such as Mozilla Firefox &amp; Google Chrome) are already provisioned with their trusted intermediate and root certificates for compatibility and performance reasons.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Using a shared dictionary allows for this compression scheme to deliver dramatically more effective compression than previous schemes, reducing the size of certificate chains in use today by ~75%, significantly improving on the ~25% reduction achieved by existing schemes. A preliminary evaluation (<a href="#eval" class="auto internal xref">Section 4</a>) of this scheme suggests that 50% of certificate chains in use today would be compressed to under 1000 bytes and 95% to under 1500 bytes. Similarly to <span>[<a href="#SCA" class="cite xref">SCA</a>]</span>, this scheme effectively removes the CA certificates from the certificate chain on the wire but this draft achieves a much better compression ratio, since <span>[<a href="#SCA" class="cite xref">SCA</a>]</span> removes the redundant information in chain that existing TLS Certificate Compression schemes exploit and is more fragile in the presence of out of sync clients or servers.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Note that as this is only a compression scheme, it does not impact any trust decisions in the TLS handshake. A client can offer this compression scheme whilst only trusting a subset of the certificates in the CCADB certificate listing, similarly a server can offer this compression scheme whilst using a certificate chain which does not chain back to a WebPKI root. Furthermore, new root certificates are typically included in the CCADB at the start of their application to a root store, a process which typically takes more than a year. Consequently, applicant root certificates can be added to new versions of this scheme ahead of any trust decisions, allowing new CAs to compete on equal terms with existing CAs. As a result this scheme is equitable in so far as it provides equal benefits for all CAs in the WebPKI, doesn't privilege any particular end-entity certificate or website and allows WebPKI clients to make individual trust decisions without fear of breakage.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relationship-to-other-drafts">
<section id="section-1.3">
        <h3 id="name-relationship-to-other-draft">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-relationship-to-other-draft" class="section-name selfRef">Relationship to other drafts</a>
        </h3>
<p id="section-1.3-1">This draft defines a certificate compression mechanism suitable for use with TLS Certificate Compression <span>[<a href="#TLSCertCompress" class="cite xref">TLSCertCompress</a>]</span>.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">The intent of this draft is to provide an alternative to CA Certificate Suppression <span>[<a href="#SCA" class="cite xref">SCA</a>]</span> as it provides a better compression ratio, can operate in a wider range of scenarios (including out of sync clients or servers) and doesn't require any additional error handling or retry mechanisms.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">CBOR Encoded X.509 (C509) <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert-05" class="cite xref">I-D.ietf-cose-cbor-encoded-cert-05</a>]</span> defines a concise alternative format for X.509 certificates. If this format were to become widely used on the WebPKI, defining an alternative version of this draft specifically for C509 certificates would be beneficial.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<p id="section-1.3-4">Compact TLS, (cTLS) <span>[<a href="#I-D.ietf-tls-ctls-08" class="cite xref">I-D.ietf-tls-ctls-08</a>]</span> defines a version of TLS1.3 which allows a pre-configured client and server to establish a session with minimal overhead on the wire. In particular, it supports the use of a predefined list of certificates known to both parties which can be compressed. However, cTLS is still at an early stage and may be challenging to deploy in a WebPKI context due to the need for clients and servers to have prior knowledge of handshake profile in use.<a href="#section-1.3-4" class="pilcrow">¶</a></p>
<p id="section-1.3-5">TLS Cached Information Extension <span>[<a href="#RFC7924" class="cite xref">RFC7924</a>]</span> introduced a new extension allowing clients to signal they had cached certificate information from a previous connection and for servers to signal that the clients should use that cache instead of transmitting a redundant set of certificates. However this RFC has seen little adoption in the wild due to concerns over client privacy.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">Handling long certificate chains in TLS-Based EAP Methods <span>[<a href="#RFC9191" class="cite xref">RFC9191</a>]</span> discusses the challenges of long certificate chains outside the WebPKI ecosystem. Although the scheme proposed in this draft is targeted at WebPKI use, defining alternative shared dictionaries for other major ecosystems may be of interest.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="status">
<section id="section-1.4">
        <h3 id="name-status">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-status" class="section-name selfRef">Status</a>
        </h3>
<p id="section-1.4-1">This draft is still at an early stage. Open questions are marked with the tag <strong>DISCUSS</strong>.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This draft refers to dates in Internet Date/Time Format as specified in <span><a href="https://rfc-editor.org/rfc/rfc3339#section-5.6" class="relref">Section 5.6</a> of [<a href="#DATES" class="cite xref">DATES</a>]</span> without the optional <code>T</code> separator.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scheme">
<section id="section-3">
      <h2 id="name-abridged-compression-scheme">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-abridged-compression-scheme" class="section-name selfRef">Abridged Compression Scheme</a>
      </h2>
<p id="section-3-1">This section describes a compression scheme suitable for compressing certificate chains used in TLS. The scheme is defined in two parts. An initial pass compressing known intermediate and root certificates and then a subsequent pass compressing the end-entity certificate.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The compression scheme in this draft has two parameters listed below which influence the construction of the static dictionary. Future versions of this draft would use different parameters and so construct different dictionaries which would be registered under different TLS Certificate Compression code points. This is discussed further in <a href="#deployment" class="auto internal xref">Section 5</a>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
          <p id="section-3-3.1.1"><code>CCADB_SNAPSHOT_TIME</code> - <code>2023-01-01 00:00:00Z</code><a href="#section-3-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.2">
          <p id="section-3-3.2.1"><code>CT_CERT_WINDOW</code> - <code>2022-12-01 00:00:00Z</code> to <code>2023-01-01 00:00:00Z</code><a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="pass-1-intermediate-and-root-compression">
<section id="section-3.1">
        <h3 id="name-pass-1-intermediate-and-roo">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-pass-1-intermediate-and-roo" class="section-name selfRef">Pass 1: Intermediate and Root Compression</a>
        </h3>
<p id="section-3.1-1">This pass relies on a shared listing of intermediate and root certificates known to both client and server. As many clients (e.g. Mozilla Firefox and Google Chrome) already ship with a list of trusted intermediate and root certificates, this pass allows their existing lists to be reused, rather than requiring them to have to be duplicated and stored in a separate format. The first subsection details how the certificates are enumerated in an ordered list. This ordered list is distributed to client and servers which use it to compress and decompress certificate chains as detailed in the subsequent subsection.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="listing">
<section id="section-3.1.1">
          <h4 id="name-enumeration-of-known-interm">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-enumeration-of-known-interm" class="section-name selfRef">Enumeration of Known Intermediate and Root Certificates</a>
          </h4>
<p id="section-3.1.1-1">The Common CA Database <span>[<a href="#CCADB" class="cite xref">CCADB</a>]</span> is operated by Mozilla on behalf of a number of Root Program operators including Mozilla, Microsoft, Google, Apple and Cisco. The CCADB contains a listing of all the root certificates trusted by these root programs, as well as their associated intermediate certificates and not yet trusted certificates from new applicants to one or more root programs.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">At the time of writing, the CCADB contains around 200 root program certificates and 2000 intermediate certificates which are trusted for TLS Server Authentication, occupying 3 MB of disk space. The listing used in this draft will be the relevant certificates included in the CCADB at <code>CCADB_SNAPSHOT_TIME</code>.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">As entries on this list typically have a lifespan of 10+ years and new certificates are added to the CCADB a year or or more before being marked as trusted, future drafts which include newer certificates will only need to be issued infrequently. This is discussed further in <a href="#deployment" class="auto internal xref">Section 5</a>.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1-4">The algorithm for enumerating the list of compressible intermediate and root certificates is given below:<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.1-5">
<li id="section-3.1.1-5.1">
              <p id="section-3.1.1-5.1.1">Query the CCADB for all known root and intermediate certificates <span>[<a href="#CCADBAllCerts" class="cite xref">CCADBAllCerts</a>]</span> as of <code>CCADB_SNAPSHOT_TIME</code><a href="#section-3.1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.1-5.2">
              <p id="section-3.1.1-5.2.1">Remove all certificates which have an extendedKeyUsage extension but do not have the TLS Server Authentication bit set or the anyExtendedKeyUsage bit set.<a href="#section-3.1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.1-5.3">
              <p id="section-3.1.1-5.3.1">Remove all certificates whose notAfter date is on or before <code>CCADB_SNAPSHOT_TIME</code>.<a href="#section-3.1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.1-5.4">
              <p id="section-3.1.1-5.4.1">Remove all root certificates which are not marked as trusted or in the process of applying to be trusted by at least one of the following browser root programs: Mozilla, Google, Microsoft, Apple.<a href="#section-3.1.1-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.1-5.5">
              <p id="section-3.1.1-5.5.1">Remove all intermediate certificates which are not signed by root certificates still in the listing.<a href="#section-3.1.1-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.1-5.6">
              <p id="section-3.1.1-5.6.1">Remove any certificates which are duplicates (have the same SHA256 certificate fingerprint)<a href="#section-3.1.1-5.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.1-5.7">
              <p id="section-3.1.1-5.7.1">Order the list of certificates by the timestamp for when each was added to the CCADB, breaking any ties with the lexicographic ordering of the SHA256 certificate fingerprint.<a href="#section-3.1.1-5.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.1-5.8">
              <p id="section-3.1.1-5.8.1">Associate each element of the list with the concatenation of the constant <code>0xff</code> and its index in the list represented as a <code>uint16</code>.<a href="#section-3.1.1-5.8.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.1.1-6">[[<strong>DISCUSS:</strong> The four programs were selected because they represent certificate consumers in the CCADB. Are there any other root programs which ought to be included? The only drawback is a larger disk requirement, since this compression scheme does not impact trust decisions.]]<a href="#section-3.1.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1.1-7">[[<strong>TODO:</strong> Ask CCADB to provide an authoritative copy of this listing. A subset of these lists is available in <code>benchmarks/data</code> in this draft's repository.]]<a href="#section-3.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression-of-ca-certificates-in-certificate-chain">
<section id="section-3.1.2">
          <h4 id="name-compression-of-ca-certifica">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-compression-of-ca-certifica" class="section-name selfRef">Compression of CA Certificates in Certificate Chain</a>
          </h4>
<p id="section-3.1.2-1">Compression Algorithm:<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2-2.1">
              <p id="section-3.1.2-2.1.1">Input: The byte representation of a <code>Certificate</code> message as defined in <span>[<a href="#TLS13" class="cite xref">TLS13</a>]</span> whose contents are <code>X509</code> certificates.<a href="#section-3.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.2-2.2">
              <p id="section-3.1.2-2.2.1">Output: <code>opaque</code> bytes suitable for transmission in a <code>CompressedCertificate</code> message defined in <span>[<a href="#TLSCertCompress" class="cite xref">TLSCertCompress</a>]</span>.<a href="#section-3.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ol start="1" type="1" class="normal type-1" id="section-3.1.2-3">
<li id="section-3.1.2-3.1">
              <p id="section-3.1.2-3.1.1">Parse the message and extract a list of <code>CertificateEntry</code>s, iterate over the list.<a href="#section-3.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-3.2">
              <p id="section-3.1.2-3.2.1">Check if <code>cert_data</code> is bitwise identical to any of the known intermediate or root certificates from the listing in the previous section.<a href="#section-3.1.2-3.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.2-3.2.2">
<li id="section-3.1.2-3.2.2.1">
                  <p id="section-3.1.2-3.2.2.1.1">If so, replace the opaque <code>cert_data</code> member of <code>CertificateEntry</code> with its adjusted three byte identifier and copy the <code>CertificateEntry</code> structure with corrected lengths to the output.<a href="#section-3.1.2-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.2-3.2.2.2">
                  <p id="section-3.1.2-3.2.2.2.1">Otherwise, copy the <code>CertificateEntry</code> entry to the output without modification.<a href="#section-3.1.2-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-3.1.2-3.3">
              <p id="section-3.1.2-3.3.1">Correct the length field for the <code>Certificate</code> message.<a href="#section-3.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.1.2-4">The resulting output should be a well-formatted <code>Certificate</code> message payload with the known intermediate and root certificates replaced with three byte identifiers.<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
<p id="section-3.1.2-5">The decompression algorithm requires the above steps but in reverse, swapping any recognized three-byte identifier in a <code>cert_data</code> field with the DER representation of the associated certificate and updating the lengths. Unrecognized three-byte identifiers are ignored.
If the compressed certificate chain cannot be parsed (e.g. due to incorrect length fields) the decompression algorithm <span class="bcp14">SHOULD</span> return the sentinel value <code>0xff</code>. Note that the connection will fail regardless even if this step is not taken as neither certificate validation nor transcript validation can succeed.<a href="#section-3.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pass-2-end-entity-compression">
<section id="section-3.2">
        <h3 id="name-pass-2-end-entity-compressi">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-pass-2-end-entity-compressi" class="section-name selfRef">Pass 2: End-Entity Compression</a>
        </h3>
<p id="section-3.2-1">This section describes a pass based on Zstandard <span>[<a href="#ZSTD" class="cite xref">ZSTD</a>]</span> with application-specified dictionaries. The dictionary is constructed with reference to the list of intermediate and root certificates discussed earlier in <a href="#listing" class="auto internal xref">Section 3.1.1</a>, as well as several external sources of information.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">[[<strong>DISCUSS:</strong> This draft is unopinionated about the underlying compression scheme is used as long as it supports application specified dictionaries. Is there an argument for using a different scheme?]]<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div id="construction-of-shared-dictionary">
<section id="section-3.2.1">
          <h4 id="name-construction-of-shared-dict">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-construction-of-shared-dict" class="section-name selfRef">Construction of Shared Dictionary</a>
          </h4>
<p id="section-3.2.1-1">[[<strong>DISCUSS / TODO:</strong> This section remains a work in progress and needs refinement. The goal is to produce a dictionary of minimal size which provides maximum compression whilst treating every CA equitably. Currently this dictionary occupies ~65KB of space, is equitable and has performance within a ~100 bytes of the best known alternative. This is discussed further in <a href="#eval" class="auto internal xref">Section 4</a>.]]<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">The dictionary is built by systematic combination of the common strings used in certificates by each issuer in the known list described in <a href="#listing" class="auto internal xref">Section 3.1.1</a>. This dictionary is constructed in three stages, with the output of each stage being concatenated with the next. Implementations of this scheme need only consume the finished dictionary and do not need to construct it themselves.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">
              <p id="section-3.2.1-3.1.1">Firstly, for each intermediate certificate enumerated in the listing in <a href="#listing" class="auto internal xref">Section 3.1.1</a>., extract the issuer field (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.4" class="relref">Section 4.1.2.4</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) and derive the matching authority key identifier (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.1" class="relref">Section 4.2.1.1</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) for the certificate. Order them according to the listing in <a href="#listing" class="auto internal xref">Section 3.1.1</a>, then copy them to the output.<a href="#section-3.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-3.2">
              <p id="section-3.2.1-3.2.1">Secondly, take the listing of certificate transparency logs trusted by the root programs selected in <a href="#listing" class="auto internal xref">Section 3.1.1</a>, which are located at<span>[<a href="#AppleCTLogs" class="cite xref">AppleCTLogs</a>]</span> <span>[<a href="#GoogleCTLogs" class="cite xref">GoogleCTLogs</a>]</span> as of <code>CCADB_SNAPSHOT_TIME</code> and extract the list of log identifiers. Remove duplicates and order them lexicographically, then copy them to the output.<a href="#section-3.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-3.3">
              <p id="section-3.2.1-3.3.1">Finally, enumerate all certificates contained within certificate transparency logs above and witnessed during <code>CT_CERT_WINDOW</code>. For each issuer in the listing in <a href="#listing" class="auto internal xref">Section 3.1.1</a>, select the first end-entity certificate when ordered by the log id (lexicographically) and latest witnessed date.<a href="#section-3.2.1-3.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3.3.2">
Extract the contents of the following extensions from the end-entity certificate selected for each issuer:<a href="#section-3.2.1-3.3.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.3.3.1">
                  <p id="section-3.2.1-3.3.3.1.1">Authority Information Access (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.2.1" class="relref">Section 4.2.2.1</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>)<a href="#section-3.2.1-3.3.3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-3.3.3.2">
                  <p id="section-3.2.1-3.3.3.2.1">Certificate Policies  (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.4" class="relref">Section 4.2.1.4</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>)<a href="#section-3.2.1-3.3.3.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-3.3.3.3">
                  <p id="section-3.2.1-3.3.3.3.1">CRL Distribution Points (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.13" class="relref">Section 4.2.1.13</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>)<a href="#section-3.2.1-3.3.3.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-3.3.3.4">
                  <p id="section-3.2.1-3.3.3.4.1">Freshest CRL (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.15" class="relref">Section 4.2.1.15</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>)<a href="#section-3.2.1-3.3.3.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.2.1-3.3.4">
Concatenate the byte representation of each extension (including extension id and length) and copy it to the output. If no end-entity certificate can be found for an issuer with this process, omit the entry for that issuer.<a href="#section-3.2.1-3.3.4" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.1-4">[[<strong>DISCUSS:</strong> This last step is picking a single certificate issued by each issuer as a canonical reference to use for compression. The ordering chosen allows the dictionary builder to stop traversing CT as soon as they've found an entry for each issuer. It would be much more efficient to just ask CAs to submit this information to the CCADB directly.]]<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<div id="compression-of-end-entity-certificates-in-certificate-chain">
<section id="section-3.2.1.1">
            <h5 id="name-compression-of-end-entity-c">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-compression-of-end-entity-c" class="section-name selfRef">Compression of End-Entity Certificates in Certificate Chain</a>
            </h5>
<p id="section-3.2.1.1-1">The resulting bytes from Pass 1 are passed to ZStandard <span>[<a href="#ZSTD" class="cite xref">ZSTD</a>]</span> with the dictionary specified in the previous section. It is <span class="bcp14">RECOMMENDED</span> that the compressor (i.e. the server) use the following parameters:<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.1-2.1">
                <p id="section-3.2.1.1-2.1.1"><code>chain_log=30</code><a href="#section-3.2.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.2">
                <p id="section-3.2.1.1-2.2.1"><code>search_log=30</code><a href="#section-3.2.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.3">
                <p id="section-3.2.1.1-2.3.1"><code>hash_log=30</code><a href="#section-3.2.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.4">
                <p id="section-3.2.1.1-2.4.1"><code>target_length=6000</code><a href="#section-3.2.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.5">
                <p id="section-3.2.1.1-2.5.1"><code>threads=1</code><a href="#section-3.2.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.6">
                <p id="section-3.2.1.1-2.6.1"><code>compression_level=22</code><a href="#section-3.2.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.7">
                <p id="section-3.2.1.1-2.7.1"><code>force_max_window=1</code><a href="#section-3.2.1.1-2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.1.1-3">These parameters are recommended in order to achieve the best compression ratio however implementations <span class="bcp14">MAY</span> use their preferred parameters as these parameters are not used during decompression. With TLS Certificate Compression, the server needs to only perform a single compression at startup and cache the result, so optimizing for maximal compression is recommended. The client's decompression speed is insensitive to these parameters.<a href="#section-3.2.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="eval">
<section id="section-4">
      <h2 id="name-preliminary-evaluation">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-preliminary-evaluation" class="section-name selfRef">Preliminary Evaluation</a>
      </h2>
<p id="section-4-1">[[<strong>NOTE:</strong> This section to be removed prior to publication.]]<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The storage footprint refers to the on-disk size required for the end-entity dictionary. The other columns report the 5th, 50th and 95th percentile of the resulting certificate chains. The evaluation set was a ~75,000 certificate chains from the Tranco list using the python scripts in the draft's Github repository.<a href="#section-4-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Scheme</th>
            <th class="text-left" rowspan="1" colspan="1">Storage Footprint</th>
            <th class="text-left" rowspan="1" colspan="1">p5</th>
            <th class="text-left" rowspan="1" colspan="1">p50</th>
            <th class="text-left" rowspan="1" colspan="1">p95</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Original</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">2308</td>
            <td class="text-left" rowspan="1" colspan="1">4032</td>
            <td class="text-left" rowspan="1" colspan="1">5609</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TLS Cert Compression</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">1619</td>
            <td class="text-left" rowspan="1" colspan="1">3243</td>
            <td class="text-left" rowspan="1" colspan="1">3821</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Intermediate Suppression and TLS Cert Compression</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">1020</td>
            <td class="text-left" rowspan="1" colspan="1">1445</td>
            <td class="text-left" rowspan="1" colspan="1">3303</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>This Draft</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">65336</td>
            <td class="text-left" rowspan="1" colspan="1">661</td>
            <td class="text-left" rowspan="1" colspan="1">1060</td>
            <td class="text-left" rowspan="1" colspan="1">1437</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>This Draft with opaque trained dictionary</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">3000</td>
            <td class="text-left" rowspan="1" colspan="1">562</td>
            <td class="text-left" rowspan="1" colspan="1">931</td>
            <td class="text-left" rowspan="1" colspan="1">1454</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Hypothetical Optimal Compression</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">377</td>
            <td class="text-left" rowspan="1" colspan="1">742</td>
            <td class="text-left" rowspan="1" colspan="1">1075</td>
          </tr>
        </tbody>
      </table>
<ul class="normal">
<li class="normal" id="section-4-4.1">
          <p id="section-4-4.1.1">'Original' refers to the sampled certificate chains without any compression.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.2">
          <p id="section-4-4.2.1">'TLS Cert Compression' used ZStandard with the parameters configured for maximum compression as defined in <span>[<a href="#TLSCertCompress" class="cite xref">TLSCertCompress</a>]</span>.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.3">
          <p id="section-4-4.3.1">'Intermediate Suppression and TLS Cert Compression' was modelled as the elimination of all certificates in the intermediate and root certificates with the Basic Constraints CA value set to true. If a cert chain included an unrecognized certificate with CA status, then no CA certificates were removed from that chain. The cert chain was then passed to 'TLS Cert Compression' as a second pass.<a href="#section-4-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.4">
          <p id="section-4-4.4.1">'This Draft with opaque trained dictionary' refers to pass 1 and pass 2 as defined by this draft, but instead using a 3000 byte dictionary for pass 2 which was produced by the Zstandard dictionary training algorithm. This illustrates a ceiling on what ought to be possible by improving the construction of the pass 2 dictionary in this document. However, using this trained dictionary directly will not treat all CA's equitably, as the dictionary will be biased towards compressing the most popular CAs more effectively.<a href="#section-4-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.5">
          <p id="section-4-4.5.1">'Hypothetical Optimal Compression' is the resulting size of the cert chain after reducing it to only the public key in the end-entity certificate, the CA signature over the EE cert, the embedded SCT signatures and a compressed list of domains in the SAN extension. This represents the best possible compression as it entirely removes any CA certs, identifiers, field tags and lengths and non-critical extensions such as OCSP, CRL and policy extensions.<a href="#section-4-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="deployment">
<section id="section-5">
      <h2 id="name-deployment-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-deployment-considerations" class="section-name selfRef">Deployment Considerations</a>
      </h2>
<div id="dictionary-versioning">
<section id="section-5.1">
        <h3 id="name-dictionary-versioning">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-dictionary-versioning" class="section-name selfRef">Dictionary Versioning</a>
        </h3>
<p id="section-5.1-1">The scheme defined in this draft is deployed with the static dictionaries constructed from the parameters listed in <a href="#scheme" class="auto internal xref">Section 3</a> fixed to a particular TLS Certificate Compression code point.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">As new CA certificates are added to the CCADB and deployed on the web, new versions of this draft would need to be issued with their own code point and dictionary parameters. However, the process of adding new root certificates to a root store is already a two to three year process and this scheme includes untrusted root certificates still undergoing the application process in its dictionary. As a result, it would be reasonable to expect a new version of this scheme with updated dictionaries to be issued at most once a year and more likely once every two or three years.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">A more detailed analysis and discussion of CA certificate lifetimes and root store operations is included in <a href="#churn" class="auto internal xref">Appendix B</a>, as well as an alternative design which would allow for dictionary negotiation rather than fixing one dictionary per code point.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">[[<strong>DISCUSS:</strong> Are there concerns over this approach? Would using at most one code point per year be acceptable? Currently 3 of the 16384 'Specification Required' IANA managed code points are in use.]]<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="version-migration">
<section id="section-5.2">
        <h3 id="name-version-migration">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-version-migration" class="section-name selfRef">Version Migration</a>
        </h3>
<p id="section-5.2-1">As new versions of this scheme are specified, clients and servers would benefit from migrating to the latest version. Whilst servers using CA certificates outside the scheme's listing can still offer this compression scheme and partially benefit from it, migrating to the latest version ensures that new CAs can compete on a level playing field with existing CAs. It is possible for a client or server to offer multiple versions of this scheme without having to pay twice the storage cost, since the majority of the stored data is in the pass 1 certificate listing and the majority of certificates will be in both versions and so need only be stored once.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Clients and servers <span class="bcp14">SHOULD</span> offer the latest version of this scheme and <span class="bcp14">MAY</span> offer one or more historical versions. Although clients and servers which fall out of date will no longer benefit from the scheme, they will not suffer any other penalties or incompatibilities. Future schemes will likely establish recommended lifetimes for sunsetting a previous version and adopting a new one.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">As the majority of clients deploying this scheme are likely to be web browsers which typically use monthly release cycles (even long term support versions like Firefox ESR offer point releases on a monthly basis), this is unlikely to be a restriction in practice. The picture is more complex for servers as operators are often to reluctant to update TLS libraries, but as a new version only requires changes to static data without any new code and would happen infrequently, this is unlikely to be burdensome in practice.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="disk-space-requirements">
<section id="section-5.3">
        <h3 id="name-disk-space-requirements">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-disk-space-requirements" class="section-name selfRef">Disk Space Requirements</a>
        </h3>
<p id="section-5.3-1">Clients and servers implementing this scheme need to store a listing of root and intermediate certificates for pass 1, which currently occupies around ~3 MB and a smaller dictionary on the order of ~100 KB for pass 2. Clients and servers offering multiple versions of this scheme do not need to duplicate the pass 1 listing, as multiple versions can refer to same string.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">As popular web browsers already ship a complete list of trusted intermediate and root certificates, their additional storage requirements are minimal. Servers offering this scheme are intended to be 'full-fat' web servers and so typically have plentiful storage already. This draft is not intended for use in storage-constrained IoT devices, but alternative versions with stripped down listings may be suitable.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">[[<strong>DISCUSS:</strong> The current draft priorities an equitable treatment for every recognized and applicant CA over minimizing storage requirements. The required disk space could be significantly reduced by only including CAs which meet a particular popularity threshold via CT log sampling.]]<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-complexity">
<section id="section-5.4">
        <h3 id="name-implementation-complexity">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-implementation-complexity" class="section-name selfRef">Implementation Complexity</a>
        </h3>
<p id="section-5.4-1">Although much of this draft is dedicated to the construction of the certificate list and dictionary used in the scheme, implementations are indifferent to these details. Pass 1 can be implemented as a simple string substitution and pass 2 with a single call to permissively licensed and widely distributed Zstandard implementations such as <span>[<a href="#ZstdImpl" class="cite xref">ZstdImpl</a>]</span>. Future versions of this draft which vary the dictionary construction then only require changes to the static data shipped with these implementations and the use of a new code point.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">There are several options for handling the distribution of the associated static data. One option is to distribute it directly with the TLS library and update it as part of that library's regular release cycle. Whilst this is easy for statically linked libraries written in languages which offer first-class package management and compile time feature selection (e.g. Go, Rust), it is trickier for dynamically linked libraries who are unlikely to want to incur the increased distribution size. In these ecosystems it may make sense to distribute the dictionaries are part of an independent package managed by the OS which can be discovered by the library at run-time. Another promising alternative would be to have existing automated certificate tooling provision the library with both the full certificate chain and multiple precompressed chains during the certificate issuance / renewal process.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">This draft does not introduce new security considerations for TLS, except for the considerations already identified in <span>[<a href="#TLSCertCompress" class="cite xref">TLSCertCompress</a>]</span>.  In particular incorrect compression or decompression will lead to the TLS connection failing as the client and server transcripts will differ, with at least one necessarily including the original certificate chain rather than the decompressed version. However, implementors <span class="bcp14">SHOULD</span> use a memory-safe language to implement this compression scheme.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Note that as this draft specifies a compression scheme, it does not impact the negotiation of trust between clients and servers and is robust in the face of changes to CCADB or trust in a particular WebPKI CA. The client's trusted list of CAs does not need to be a subset or superset of the CCADB list and revocation of trust in a CA does not impact the operation of this compression scheme. Similarly, servers who use roots or intermediates outside the CCADB can still offer and benefit from this scheme.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">[[<strong>TODO:</strong> Adopt an identifier for experimental purposes.]]<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="AppleCTLogs">[AppleCTLogs]</dt>
        <dd>
<span class="refAuthor">Apple</span>, <span class="refTitle">"Certificate Transparency Logs trusted by Apple"</span>, <time datetime="2023-06-05" class="refDate">5 June 2023</time>, <span>&lt;<a href="https://valid.apple.com/ct/log_list/current_log_list.json">https://valid.apple.com/ct/log_list/current_log_list.json</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CCADBAllCerts">[CCADBAllCerts]</dt>
        <dd>
<span class="refAuthor">Mozilla</span>, <span class="refAuthor">Microsoft</span>, <span class="refAuthor">Google</span>, <span class="refAuthor">Apple</span>, and <span class="refAuthor">Cisco</span>, <span class="refTitle">"CCADB Certificates Listing"</span>, <time datetime="2023-06-05" class="refDate">5 June 2023</time>, <span>&lt;<a href="https://ccadb.my.salesforce-sites.com/ccadb/AllCertificateRecordsCSVFormat">https://ccadb.my.salesforce-sites.com/ccadb/AllCertificateRecordsCSVFormat</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DATES">[DATES]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span> and <span class="refAuthor">C. Newman</span>, <span class="refTitle">"Date and Time on the Internet: Timestamps"</span>, <span class="seriesInfo">RFC 3339</span>, <span class="seriesInfo">DOI 10.17487/RFC3339</span>, <time datetime="2002-07" class="refDate">July 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3339">https://www.rfc-editor.org/rfc/rfc3339</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GoogleCTLogs">[GoogleCTLogs]</dt>
        <dd>
<span class="refAuthor">Google</span>, <span class="refTitle">"Certificate Transparency Logs trusted by Google"</span>, <time datetime="2023-06-05" class="refDate">5 June 2023</time>, <span>&lt;<a href="https://source.chromium.org/chromium/chromium/src/+/main:components/certificate_transparency/data/log_list.json">https://source.chromium.org/chromium/chromium/src/+/main:components/certificate_transparency/data/log_list.json</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS13">[TLS13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLSCertCompress">[TLSCertCompress]</dt>
        <dd>
<span class="refAuthor">Ghedini, A.</span> and <span class="refAuthor">V. Vasiliev</span>, <span class="refTitle">"TLS Certificate Compression"</span>, <span class="seriesInfo">RFC 8879</span>, <span class="seriesInfo">DOI 10.17487/RFC8879</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8879">https://www.rfc-editor.org/rfc/rfc8879</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZSTD">[ZSTD]</dt>
      <dd>
<span class="refAuthor">Collet, Y.</span> and <span class="refAuthor">M. Kucherawy, Ed.</span>, <span class="refTitle">"Zstandard Compression and the 'application/zstd' Media Type"</span>, <span class="seriesInfo">RFC 8878</span>, <span class="seriesInfo">DOI 10.17487/RFC8878</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8878">https://www.rfc-editor.org/rfc/rfc8878</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CCADB">[CCADB]</dt>
        <dd>
<span class="refAuthor">Mozilla</span>, <span class="refAuthor">Microsoft</span>, <span class="refAuthor">Google</span>, <span class="refAuthor">Apple</span>, and <span class="refAuthor">Cisco</span>, <span class="refTitle">"Common CA Database"</span>, <time datetime="2023-06-05" class="refDate">5 June 2023</time>, <span>&lt;<a href="https://www.ccadb.org/">https://www.ccadb.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FastlyStudy">[FastlyStudy]</dt>
        <dd>
<span class="refAuthor">McManus, P.</span>, <span class="refTitle">"Does the QUIC handshake require compression to be fast?"</span>, <time datetime="2020-05-18" class="refDate">18 May 2020</time>, <span>&lt;<a href="https://www.fastly.com/blog/quic-handshake-tls-compression-certificates-extension-study">https://www.fastly.com/blog/quic-handshake-tls-compression-certificates-extension-study</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert-05">[I-D.ietf-cose-cbor-encoded-cert-05]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-05</span>, <time datetime="2023-01-10" class="refDate">10 January 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-05">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-ctls-08">[I-D.ietf-tls-ctls-08]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">B. M. Schwartz</span>, <span class="refTitle">"Compact TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-ctls-08</span>, <time datetime="2023-03-13" class="refDate">13 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-ctls-08">https://datatracker.ietf.org/doc/html/draft-ietf-tls-ctls-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PQStudy">[PQStudy]</dt>
        <dd>
<span class="refAuthor">Westerbaan, B.</span>, <span class="refTitle">"Sizing Up Post-Quantum Signatures"</span>, <time datetime="2021-11-08" class="refDate">8 November 2021</time>, <span>&lt;<a href="https://blog.cloudflare.com/sizing-up-post-quantum-signatures/">https://blog.cloudflare.com/sizing-up-post-quantum-signatures/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUICStudy">[QUICStudy]</dt>
        <dd>
<span class="refAuthor">Nawrocki, M.</span>, <span class="refAuthor">Tehrani, P.</span>, <span class="refAuthor">Hiesgen, R.</span>, <span class="refAuthor">Mücke, J.</span>, <span class="refAuthor">Schmidt, T.</span>, and <span class="refAuthor">M. Wählisch</span>, <span class="refTitle">"On the interplay between TLS certificates and QUIC performance"</span>, <span class="refContent">ACM</span>, <span class="seriesInfo">Proceedings of the 18th International Conference on emerging Networking EXperiments and Technologies</span>, <span class="seriesInfo">DOI 10.1145/3555050.3569123</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://doi.org/10.1145/3555050.3569123">https://doi.org/10.1145/3555050.3569123</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7924">[RFC7924]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Transport Layer Security (TLS) Cached Information Extension"</span>, <span class="seriesInfo">RFC 7924</span>, <span class="seriesInfo">DOI 10.17487/RFC7924</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7924">https://www.rfc-editor.org/rfc/rfc7924</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9191">[RFC9191]</dt>
        <dd>
<span class="refAuthor">Sethi, M.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Handling Large Certificates and Long Certificate Chains in TLS-Based EAP Methods"</span>, <span class="seriesInfo">RFC 9191</span>, <span class="seriesInfo">DOI 10.17487/RFC9191</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9191">https://www.rfc-editor.org/rfc/rfc9191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCA">[SCA]</dt>
        <dd>
<span class="refAuthor">Kampanakis, P.</span>, <span class="refAuthor">Bytheway, C.</span>, <span class="refAuthor">Westerbaan, B.</span>, and <span class="refAuthor">M. Thomson</span>, <span class="refTitle">"Suppressing CA Certificates in TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-kampanakis-tls-scas-latest-03</span>, <time datetime="2023-01-05" class="refDate">5 January 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kampanakis-tls-scas-latest-03">https://datatracker.ietf.org/doc/html/draft-kampanakis-tls-scas-latest-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCAStudy">[SCAStudy]</dt>
        <dd>
<span class="refAuthor">Kampanakis, P.</span> and <span class="refAuthor">M. Kallitsis</span>, <span class="refTitle">"Faster Post-Quantum TLS Handshakes Without Intermediate CA Certificates"</span>, <span class="refContent">Springer International Publishing</span>, <span class="seriesInfo">Cyber Security, Cryptology, and Machine Learning pp. 337-355</span>, <span class="seriesInfo">DOI 10.1007/978-3-031-07689-3_25</span>, <span class="seriesInfo">ISBN ["9783031076886", "9783031076893"]</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-031-07689-3_25">https://doi.org/10.1007/978-3-031-07689-3_25</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZstdImpl">[ZstdImpl]</dt>
      <dd>
<span class="refAuthor">Facebook</span>, <span class="refTitle">"ZStandard (Zstd)"</span>, <time datetime="2023-06-05" class="refDate">5 June 2023</time>, <span>&lt;<a href="https://github.com/facebook/zstd">https://github.com/facebook/zstd</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors thank Bas Westerbaan, Martin Thomson and Kathleen Wilson for feedback on early versions of this document.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="churn">
<section id="appendix-B">
      <h2 id="name-ccadb-churn-and-dictionary-">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-ccadb-churn-and-dictionary-" class="section-name selfRef">CCADB Churn and Dictionary Negotiation</a>
      </h2>
<div id="ccadb-churn">
<section id="appendix-B.1">
        <h3 id="name-ccadb-churn">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-ccadb-churn" class="section-name selfRef">CCADB Churn</a>
        </h3>
<p id="appendix-B.1-1">Typically around 10 or so new root certificates are introduced to the WebPKI each year. The various root programs restrict the lifetimes of these certificates, Microsoft to between 8 and 25 years (<a href="https://learn.microsoft.com/en-us/security/trusted-root/program-requirements">3.A.3</a>), Mozilla to between 0 and 14 years (<a href="https://wiki.mozilla.org/CA/Root_CA_Lifecycles">Summary</a>). Chrome has proposed a maximum lifetime of 7 years in the future (<a href="https://www.chromium.org/Home/chromium-security/root-ca-policy/moving-forward-together/">Blog Post</a>). Some major CAs have objected to this proposed policy as the root inclusion process currently takes around 3 years from start to finish (<a href="https://www.digicert.com/blog/googles-moving-forward-together-proposals-for-root-ca-policy">Digicert Blog</a>). Similarly, Mozilla requires CAs to apply to renew their roots with at least 2 years notice (<a href="https://wiki.mozilla.org/CA/Root_CA_Lifecycles">Summary</a>).<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">Typically around 100 to 200 new WebPKI intermediate certificates are issued each year. No WebPKI root program currently limits the lifetime of intermediate certificates, but they are in practice capped by the lifetime of their parent root certificate. The vast majority of these certificates are issued with 10 year lifespans. A small but notable fraction (&lt;10%) are issued with 2 or 3 year lifetimes. Chrome's Root Program has proposed that Intermediate Certificates be limited to 3 years in the future (<a href="https://www.chromium.org/Home/chromium-security/root-ca-policy/moving-forward-together/">Update</a>). However, the motivation for this requirement is unclear. Unlike root certificates, intermediate certificates are only required to be disclosed with a month's notice to the CCADB (<a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/#53-intermediate-certificates">Mozilla Root Program Section 5.3.2</a>, <a href="https://www.chromium.org/Home/chromium-security/root-ca-policy/">Chrome Policy</a>).<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dictionary-negotiation">
<section id="appendix-B.2">
        <h3 id="name-dictionary-negotiation">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-dictionary-negotiation" class="section-name selfRef">Dictionary Negotiation</a>
        </h3>
<p id="appendix-B.2-1">This draft is currently written with a view to being adopted as a particular TLS Certificate Compression Scheme. However, this means that each dictionary used in the wild must have an assigned code point. A new dictionary would likely need to be issued no more than yearly. However, negotiating the dictionary used would avoid the overhead of minting a new draft and code point. A sketch for how dictionary negotiation might work is below.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">This draft would instead define a new extension, which would define TLS Certificate Compression with ZStandard Dictionaries. Dictionaries would be identified by an IANA-assigned identifier of two bytes, with a further two bytes for the major version and two more for the minor version. Adding new certificates to a dictionary listing would require a minor version bump. Removing certificates or changing the pass 2 dictionary would require a major version bump.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-3">
<pre>
struct {
  uint16 identifier;
  uint16 major_version;
  uint16 minor_version;
} DictionaryId

struct {
  DictionaryId supported_dictionaries&lt;6..2^16-1&gt;
} ZStdSharedDictXtn
</pre><a href="#appendix-B.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-4">The client lists their known dictionaries in an extension in the ClientHello. The client need only retain and advertise the highest known minor version for any major version of a dictionary they are willing to offer. The server may select any dictionary it has a copy of with matching identifier, matching major version number and a minor version number not greater than the client's minor version number.<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
<p id="appendix-B.2-5">The expectation would be that new minor versions would be issued monthly or quarterly, with new major versions only every year or multiple years. This reflects the relative rates of when certificates are added or removed to the CCADB listing. This means in practice clients would likely offer a single dictionary containing their latest known version. Servers would only need to update their dictionaries yearly when a new major version is produced.<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dennis Jackson</span></div>
<div dir="auto" class="left"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@dennis-jackson.uk" class="email">ietf@dennis-jackson.uk</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
